function AutoRun(n){tindex=(tindex+1)%n.length,$(n[tindex]).trigger("click")}function lookup_alltask(n,t,i,r){$.ajax({type:"POST",url:domain_url+"cv?m=fac",data:{productId:n,pageNo:t,pageSize:20},dataType:"jsonp",cache:!1,async:!0,crossDomain:!0,jsonp:"callback",jsonpCallback:"callback",success:function(u){lookup_data(n,t,i,r,u)},complete:function(){},error:function(){alert("服务器繁忙，请稍后重试！")}})}function imgResize(n,t,i){var r=trimNull(n),f=r.substring(r.lastIndexOf(".")),u=r.split("=")[1];return u!=undefined?(u=u.split(".")[0].split("X"),u==undefined&&(u=[200,200])):(r=r+"="+t+"X"+i+f,u=[200,200]),r}function lookup_data(n,t,i,r,u){for(var e="",s=1,o=u[0].result,s=u[0].totalPages,h,f=0;f<o.length;f++)h=imgResize(o[f].userIcon,userIconW,userIconH),e+='<li><span class="pic" userId="'+o[f].userId+'"><img src="'+h+'" width="'+userIconW+'" height="'+userIconH+'"><\/span><p><a>"'+o[f].userName+'"<\/a><span>'+o[f].content+'<\/span><\/p><div class="clear"><\/div><\/li>';r==1?(e='<div class="share share_all" id="share_aCom"><ul>'+e+'<\/ul><\/div><div id="pagination-aCom"><\/div>',art.dialog({title:$("#"+n).find(".prodimg").attr("title")+"的商品所有评论",content:e,width:600,height:380,top:100,lock:!0}),aCom_pagingtion(s,t,n,i)):($("#share_aCom").html("<ul>"+e+"<\/ul>"),aCom_pageroll(s,t))}function upload_likebase(n,t){$.ajax({url:domain_url+"cv?m=ulb",data:{productId:n,likebaseSta:t,channCode:channCode},dataType:"jsonp",cache:!1,async:!0,crossDomain:!0,jsonp:"callback",jsonpCallback:"callback",success:function(){},complete:function(){},error:function(){}})}function load_data(){reload_fun=!1,$.ajax({url:domain_url+"cv?m=getpc",data:{pageNo:now_page_tmp,pageSize:load_cont,channCode:channCode,pricePlace:price_s},dataType:"jsonp",cache:!1,async:!0,crossDomain:!0,jsonp:"callback",jsonpCallback:"callback",success:function(n){n.totalPages=="0"?($("#page_more").hide(),$("#container").css({"font-size":"16px","text-align":"center","padding-top":"24px"}).html("暂无匹配数据，请浏览其它选项！")):blocklist_data(n)},complete:function(){},error:function(){alert("服务器繁忙，请稍后重试！")}})}function blocklist_data(n){for(var u="",i=n.result,c=i.length,f,o,s,e,r,h,t=0;t<c;t++){if(f=i[t].prodName,o=trimNull(i[t].price),f.length>30&&(f=f.substr(0,30)+"..."),s=imgResize(i[t].imgUrl,imgUrlW,imgUrlH),u+='<div class="grid"><div class="gridbg" id="'+i[t].prodId+'"><div class="imgholder"><div class="itemprice"><span class="num">¥'+o+'<\/span><\/div><a href="'+i[t].prodLink+'" target="_blank"><img src="'+s+'" class="prodimg"  title="'+i[t].prodName+'" alt="'+i[t].prodName+'" width="'+imgUrlW+'" height="'+imgUrlH+'"><\/a><\/div><div class="info"><div class="tbuy"><div class="tbuybg"><a href="'+i[t].prodLink+'" target="_blank" title="立即购买">立即购买<\/a><\/div><\/div><p>'+f+'<\/p><div class="info_fun"><div class="like" prodid="'+i[t].prodId+'"><a class="likeit" href="javascript:;"><\/a><span class="likecont">'+trimNull(i[t].likeBase)+'<\/span><\/div><div class="comment"><span class="commenttxt">评论<\/span><span class="num">'+i[t].commentCount+'<\/span><\/div><\/div><div class="clear"><\/div><\/div>',i[t].comments.length>0){for(e=3,i[t].comments.length<=2&&(e=i[t].comments.length),r=0;r<Math.ceil(Math.random()*e);r++)h=imgResize(i[t].comments[r].USERICON,userIconW,userIconH),u+='<div class="share"><div class="pic"><img src="'+h+'"  width="'+userIconW+'" height="'+userIconH+'" /><\/div><p><a class="name" href="javascript:;">'+trimNull(i[t].comments[r].USERNAME)+"<\/a><span>"+trimNull(i[t].comments[r].CONTENT)+'<\/span><\/p><div class="clear"><\/div><\/div>';i[t].commentCount>2&&(u+='<div class="comm_share"><a href="javascript:;"> 查看全部'+trimNull(i[t].commentCount)+"条评论...<\/a>  <\/div>")}u+="<\/div><\/div>"}if($cps_body.append(u),$cps_body.BlocksIt({numOfCol:numOfCol_cont,offsetX:cps_offset_x,offsetY:cps_offset_y}),now_cont++,st1_page&&(total_page=Math.ceil(parseInt(n.totalPages)/page_cont),total_page<page_cont,c_pagingtion(),$(window).trigger("scroll"),st1_page=!1),now_cont==page_cont||now_cont==parseInt(n.totalPages)){$("#load_more").hide(),$("#pagination-cps").show();return}now_cont<page_cont&&(reload_fun=!0,now_page_tmp++,$("#load_more").show()),GetUserInfo()}function reset_pul(n){$cps_body.html("").removeAttr("style"),$(window).scrollTop(0),now_cont=0,n==1&&(st1_page=!0),load_data(),pageroll()}function c_pagingtion(){}function pageroll(){if(now_page==1&&now_page==total_page){$("#pagination-cps .previous").addClass("previous-off"),$("#pagination-cps .next").addClass("next-off");return}now_page<total_page&&now_page!=1?($("#pagination-cps .previous").removeClass("previous-off"),$("#pagination-cps .next").removeClass("next-off")):now_page>=total_page?($("#pagination-cps .next").addClass("next-off"),$("#pagination-cps .previous").removeClass("previous-off")):now_page==1&&$("#pagination-cps .previous").addClass("previous-off")}function aCom_pagingtion(n,t,i,r){var f,u;$(document).off("click","#pagination-aCom a").on("click","#pagination-aCom a",function(){$(this).hasClass("previous")?t!=1&&(t--,$("#pagination-aCom a").removeClass("active").eq(t).addClass("active"),lookup_alltask(i,t,r)):$(this).hasClass("next")?t!=n&&(t++,$("#pagination-aCom a").removeClass("active").eq(t).addClass("active"),lookup_alltask(i,t,r)):(t=parseInt($(this).text()),$("#pagination-aCom a").removeClass("active"),$(this).addClass("active"),lookup_alltask(i,t,r))});if(n!=1){for(f='<a index="-1" class="previous previous-off"  href="javascript:;">&#171;上一页<\/a><a index="0" class="active" href="javascript:;">1<\/a>',u=2;u<=n;u++)f+='<a index="'+u+'" href="javascript:;">'+u+"<\/a>";f+='<a index="1" class="next" href="javascript:;">下一页 &#187;<\/a>',$("#pagination-aCom").html(f)}}function aCom_pageroll(n,t){if(t==1&&t==n){$("#pagination-aCom .previous").addClass("previous-off"),$("#pagination-aCom .next").addClass("next-off");return}t<n&&t!=1?($("#pagination-aCom .previous").removeClass("previous-off"),$("#pagination-aCom .next").removeClass("next-off")):t>=n?($("#pagination-aCom .next").addClass("next-off"),$("#pagination-aCom .previous").removeClass("previous-off")):t==1&&$("#pagination-aCom .previous").addClass("previous-off")}function trimNull(n){return n==null||n==undefined||n=="null"?"":n}function recontent_size(){var t=$(window).width(),n;t<=1120||(n=1188,numOfCol_cont=numOfCol_cont),n!=currentWidth&&(currentWidth=n,$cps_body.width(n),$cps_body.BlocksIt({numOfCol:numOfCol_cont,offsetX:cps_offset_x,offsetY:cps_offset_y}))}function GetUserInfo(){var n="http://login.cn100.com";n!=""&&$.ajax({type:"GET",url:""+n+"/AjaxFile/UserInfo.ashx",data:{t:1,ac:"useranddomain",template:1},dataType:"jsonp",cache:!1,crossDomain:!0,jsonp:"jsoncallback",success:function(n){var i=n[2],r=n[0],t="";$(".cn100_shops").replaceWith(i.Html),t=$(".cn100_welcome a:first").html(),t=="登录"?$("body").removeClass("shutLoginWindow").addClass("openLoginWindow"):($("body").removeClass("openLoginWindow").addClass("shutLoginWindow"),$.cookie(t)!==null&&$($.cookie(t)).find(".like").addClass("liked"))},complete:function(){},error:function(){}})}var domain_url="http://ada.cn100.com/",$listbox=$("#listbox li"),$clicklist=$("#clicklist li"),Tlistbox=$listbox[0],Tclicklist=$clicklist[0],index=tindex=FadeTemp=0,$cps_body=$("#container"),currentWidth=1188,numOfCol_cont=5,cps_offset_x=5,cps_offset_y=7,imgUrlW=200,imgUrlH=200,userIconW=32,userIconH=32,temp_len=30,st1_page=!0,reload_fun=!0,i_len=0,now_page=1,now_page_tmp=2,load_cont=15,now_cont=0,page_cont=5,total_page=Math.ceil(5/page_cont),price_s="",cps_redpacket;$(window).load(function(){$(window).wresize(recontent_size),recontent_size(),$(window).scroll(function(){if(reload_fun&&now_cont!=page_cont){var n=$(window).height(),r=$(window).width(),i=$(document).scrollTop(),t=$("#load_more").offset();(t.top<=n||n+i>=t.top)&&load_data()}});$(document).on("mouseenter mouseleave","#container .grid",function(n){n.type=="mouseenter"?$(this).addClass("ghover"):$(this).removeClass("ghover")});$(document).on("click","#container .comm_share",function(){var n=$(this).parent().attr("id");lookup_alltask(n,1,20,1)});$(document).on("click","#container .grid .like",function(){var r,e;if($("body").hasClass("openLoginWindow"))r='<div id="curloginboxcou"><div id="divUser" class="LO_divUser"><p class="divUser_name"><span>用户名：<\/span><input type="text" name="UserName" value=""><\/p><p><span style="margin-right: 0px;">密&nbsp;&nbsp;码：<\/span><input type="password" name="UserPWD" value=""><\/p><\/div><div id="tipmsg" style="color:Red"><\/div><div style="text-align:center;padding-top:5px;"><input type="button" value="登录" name="btLogin" id="btLogin" onclick=\'cps_redpacket.login()\'><\/div><div style="text-align:right;padding-right:5px;margin-top:20px;"><a id="forgetPassword" href="http://login.cn100.com/ForgetPassword.aspx">忘记密码？<\/a> | <a id="linkReg" href="http://member.cn100.com/UserRegister/MemberRegisterMgr.aspx">免费注册<\/a><\/div><\/div>',art.dialog({title:"用户登录",content:r,width:300,height:150,top:300,fixed:!0,lock:!0,id:"mylogin"});else if($("body").hasClass("shutLoginWindow")){var u="",o=$(this).attr("prodid"),t=$(".likecont",this).text(),i=$(".cn100_welcome a:first").html(),f=$.cookie(i)===null?"":$.cookie(i);t==""&&(t=0),t=parseInt(t),$(this).hasClass("liked")||($(this).addClass("liked"),u="1",$(".likecont",this).html(t+1),f+="#"+$(this).parents(".gridbg").attr("id")+",",e=new Date,$.cookie(i,f,{expires:new Date(e.setHours(23,59,59))}),upload_likebase(o,u))}});$(document).on("click","#price_space li",function(){$("#price_space li").removeClass("selected"),$(this).addClass("selected"),price_s=$(this).attr("price_s"),price_s=="all"&&(price_s=""),now_page_tmp=1,reset_pul(1),c_pagingtion()});$clicklist.click(function(){if($(this).hasClass("ban_select"))return!1;var n=$clicklist.index($(this));return tindex=n,$(this).addClass("ban_select").siblings().removeClass("ban_select"),$(Tlistbox).fadeOut(1e3),$($listbox[n]).fadeIn(1e3),Tclicklist=$(this),Tlistbox=$listbox[n],!1}),$(Tclicklist).trigger("click"),FadeT=setInterval(function(){AutoRun($clicklist)},5e3),$clicklist.add($listbox).hover(function(){clearInterval(FadeT)},function(){FadeT=setInterval(function(){AutoRun($clicklist)},5e3)})}),function(n){n.fn.wresize=function(t){function i(){var t,i;if(n.browser.msie)if(wresize.fired){if(t=parseInt(n.browser.version,10),wresize.fired=!1,t<7)return!1;if(t==7&&(i=n(window).width(),i!=wresize.width))return wresize.width=i,!1}else wresize.fired=!0;return!0}function r(n){if(i())return t.apply(this,[n])}return version="1.1",wresize={fired:!1,width:0},this.each(function(){this==window?n(this).resize(r):n(this).resize(t)}),this}}(jQuery),jQuery.cookie=function(n,t,i){var u,r,f,e;return arguments.length>1&&(t===null||typeof t!="object")?(i=jQuery.extend({},i),t===null&&(i.expires=-1),typeof i.expires=="number"&&(u=i.expires,r=i.expires=new Date,r.setDate(r.getDate()+u)),document.cookie=[encodeURIComponent(n),"=",i.raw?String(t):encodeURIComponent(String(t)),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")):(i=t||{},e=i.raw?function(n){return n}:decodeURIComponent,(f=new RegExp("(?:^|; )"+encodeURIComponent(n)+"=([^;]*)").exec(document.cookie))?e(f[1]):null)},cps_redpacket={},cps_redpacket.login=function(){var f=$(this),i=$("#curloginboxcou"),n=i.find("input[name='UserName']"),t=i.find("input[name='UserPWD']"),r,u;if($.trim(n.val())==""){n.focus();return}if($.trim(t.val())==""){t.focus();return}r="http://login.cn100.com/AjaxFile/AjaxLogin.ashx?ra="+Math.random(),u={UserName:n.val(),Pwd:t.val()},$.ajax({type:"GET",async:!0,url:r,data:u,dataType:"jsonp",cache:!1,jsonp:"jsoncallback",crossDomain:!0,success:function(n){if(n.result==0)$("#tipmsg").html(n.msg);else{var t="_Customer_Cn100_COM="+n.msg+"; domain='.cn100.com'; path=/;";document.cookie=t,art.dialog({id:"mylogin"}).close(),GetUserInfo()}}})}